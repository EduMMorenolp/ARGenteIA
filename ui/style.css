/* ─── Reset & Base ─────────────────────────────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg-base:     #0d0f14;
  --bg-sidebar:  #111318;
  --bg-surface:  #181b22;
  --bg-input:    #1e2130;
  --bg-msg-user: #1a2a4a;
  --bg-msg-bot:  #181b22;
  --border:      #2a2e3d;
  --accent:      #4f8cff;
  --accent-dim:  #2a4a8a;
  --text:        #e8eaf0;
  --text-dim:    #8892a4;
  --text-muted:  #525a6e;
  --font:        'Inter', system-ui, sans-serif;
  --mono:        'JetBrains Mono', 'Fira Code', monospace;
  --radius:      12px;
  --radius-sm:   8px;
  --shadow:      0 4px 24px rgba(0,0,0,0.4);
}

html, body { height: 100%; overflow: hidden; }
body { font-family: var(--font); background: var(--bg-base); color: var(--text); font-size: 14px; line-height: 1.6; }

/* ─── Layout ───────────────────────────────────────────────────────────── */
.app { display: grid; grid-template-columns: 240px 1fr; height: 100vh; overflow: hidden; }

/* ─── Sidebar ──────────────────────────────────────────────────────────── */
.sidebar {
  background: var(--bg-sidebar);
  border-right: 1px solid var(--border);
  display: flex; flex-direction: column; gap: 0;
  overflow: hidden;
}

.sidebar-header { padding: 20px 16px 16px; border-bottom: 1px solid var(--border); }
.logo { display: flex; align-items: center; gap: 10px; }
.logo-icon { font-size: 22px; }
.logo-text { font-size: 16px; font-weight: 600; color: var(--text); }

.model-info { padding: 16px; border-bottom: 1px solid var(--border); }
.model-label { font-size: 11px; text-transform: uppercase; letter-spacing: .08em; color: var(--text-muted); margin-bottom: 4px; }
.model-name { font-family: var(--mono); font-size: 12px; color: var(--accent); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

.commands-list { padding: 12px 10px; flex: 1; display: flex; flex-direction: column; gap: 4px; }
.commands-title { font-size: 11px; text-transform: uppercase; letter-spacing: .08em; color: var(--text-muted); padding: 0 6px; margin-bottom: 6px; }
.cmd-btn {
  width: 100%; text-align: left; background: transparent; border: none;
  color: var(--text-dim); font-family: var(--font); font-size: 13px;
  padding: 8px 10px; border-radius: var(--radius-sm); cursor: pointer;
  transition: background .15s, color .15s;
}
.cmd-btn:hover { background: var(--bg-surface); color: var(--text); }
.cmd-btn:active { transform: scale(.98); }

.sidebar-footer { padding: 12px 16px; border-top: 1px solid var(--border); display: flex; flex-direction: column; gap: 6px; }
.connection-status { display: flex; align-items: center; gap: 8px; }
.status-dot { width: 8px; height: 8px; border-radius: 50%; background: #ff4444; transition: background .3s; }
.status-dot.connected { background: #44e056; box-shadow: 0 0 6px #44e056; }
.status-text { font-size: 12px; color: var(--text-muted); }
.msg-count { font-size: 11px; color: var(--text-muted); }

/* ─── Chat Area ────────────────────────────────────────────────────────── */
.chat-area { display: flex; flex-direction: column; overflow: hidden; background: var(--bg-base); }

.chat-header {
  padding: 16px 24px;
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; justify-content: space-between;
  background: var(--bg-sidebar);
}
.chat-header h1 { font-size: 17px; font-weight: 600; }

/* ─── Typing Indicator ─────────────────────────────────────────────────── */
.typing-indicator { display: flex; align-items: center; gap: 6px; }
.typing-indicator span {
  width: 6px; height: 6px; background: var(--accent); border-radius: 50%;
  animation: bounce .9s infinite ease-in-out;
}
.typing-indicator span:nth-child(2) { animation-delay: .15s; }
.typing-indicator span:nth-child(3) { animation-delay: .3s; }
.typing-indicator small { color: var(--text-dim); font-size: 12px; }
@keyframes bounce { 0%,80%,100% { transform: scale(.6); opacity:.4; } 40% { transform: scale(1); opacity:1; } }

/* ─── Messages ─────────────────────────────────────────────────────────── */
.messages { flex: 1; overflow-y: auto; padding: 24px; display: flex; flex-direction: column; gap: 16px; scroll-behavior: smooth; }
.messages::-webkit-scrollbar { width: 6px; }
.messages::-webkit-scrollbar-track { background: transparent; }
.messages::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

.welcome-msg { text-align: center; padding: 60px 20px; color: var(--text-dim); }
.welcome-icon { font-size: 48px; margin-bottom: 16px; }
.welcome-msg h2 { font-size: 20px; font-weight: 600; color: var(--text); margin-bottom: 8px; }
.welcome-msg p { line-height: 1.7; }

/* Message bubbles */
.message { display: flex; gap: 12px; animation: fadeIn .2s ease; max-width: 820px; }
.message.user { flex-direction: row-reverse; margin-left: auto; }
@keyframes fadeIn { from { opacity:0; transform: translateY(8px); } to { opacity:1; transform: none; } }

.msg-avatar {
  width: 32px; height: 32px; border-radius: 50%;
  background: var(--bg-surface); border: 1px solid var(--border);
  display: flex; align-items: center; justify-content: center;
  font-size: 16px; flex-shrink: 0; align-self: flex-end;
}
.message.user .msg-avatar { background: var(--accent-dim); border-color: var(--accent); }

.msg-bubble {
  background: var(--bg-msg-bot);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 12px 16px;
  max-width: calc(100% - 48px);
  word-break: break-word;
}
.message.user .msg-bubble {
  background: var(--bg-msg-user);
  border-color: var(--accent-dim);
}

.msg-meta { font-size: 11px; color: var(--text-muted); margin-bottom: 6px; }
.msg-content { color: var(--text); line-height: 1.7; }

/* Command result */
.msg-bubble.command {
  background: #0f1a0f;
  border-color: #2d4a2d;
  font-family: var(--mono);
  font-size: 13px;
}

/* Markdown inside messages */
.msg-content p { margin-bottom: 8px; }
.msg-content p:last-child { margin-bottom: 0; }
.msg-content ul, .msg-content ol { padding-left: 20px; margin-bottom: 8px; }
.msg-content li { margin-bottom: 4px; }
.msg-content code { font-family: var(--mono); background: rgba(255,255,255,.08); padding: 2px 5px; border-radius: 4px; font-size: .9em; }
.msg-content pre { background: #0a0c12; border: 1px solid var(--border); border-radius: var(--radius-sm); padding: 12px; overflow-x: auto; margin: 8px 0; }
.msg-content pre code { background: none; padding: 0; }
.msg-content strong { color: var(--text); font-weight: 600; }
.msg-content h1,.msg-content h2,.msg-content h3 { margin: 10px 0 6px; color: var(--text); }
.msg-content blockquote { border-left: 3px solid var(--accent-dim); padding-left: 12px; color: var(--text-dim); margin: 8px 0; }
.msg-content a { color: var(--accent); text-decoration: none; }
.msg-content a:hover { text-decoration: underline; }
.msg-content table { border-collapse: collapse; width: 100%; margin: 8px 0; }
.msg-content th, .msg-content td { border: 1px solid var(--border); padding: 6px 10px; text-align: left; }
.msg-content th { background: var(--bg-input); }

/* Error message */
.msg-bubble.error { background: #1a0808; border-color: #4a2020; color: #ff8888; }

/* ─── Input Area ───────────────────────────────────────────────────────── */
.input-area { padding: 16px 24px 20px; border-top: 1px solid var(--border); background: var(--bg-sidebar); }
.input-wrapper { display: flex; gap: 10px; align-items: flex-end; background: var(--bg-input); border: 1px solid var(--border); border-radius: var(--radius); padding: 10px 12px; transition: border-color .2s; }
.input-wrapper:focus-within { border-color: var(--accent); box-shadow: 0 0 0 2px rgba(79,140,255,.15); }

#user-input {
  flex: 1; background: none; border: none; outline: none;
  color: var(--text); font-family: var(--font); font-size: 14px; line-height: 1.5;
  resize: none; max-height: 200px; min-height: 24px;
}
#user-input::placeholder { color: var(--text-muted); }

#send-btn {
  width: 36px; height: 36px; background: var(--accent); border: none; border-radius: var(--radius-sm);
  color: white; cursor: pointer; display: flex; align-items: center; justify-content: center;
  transition: background .15s, transform .1s; flex-shrink: 0;
}
#send-btn:hover { background: #6aa0ff; }
#send-btn:active { transform: scale(.95); }
#send-btn:disabled { background: var(--bg-surface); cursor: not-allowed; }
#send-btn svg { width: 18px; height: 18px; }

/* ─── Responsive ───────────────────────────────────────────────────────── */
@media (max-width: 640px) {
  .app { grid-template-columns: 1fr; }
  .sidebar { display: none; }
}
